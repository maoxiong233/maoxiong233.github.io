{"name":"Maoxiong233.GitHub.io","tagline":"","body":"\r\n\r\n<div id=\"header\">\r\n<h1 class=\"title\">Work</h1>\r\n<h4 class=\"author\"><em>DL</em></h4>\r\n<h4 class=\"date\"><em>26 December 2015</em></h4>\r\n</div>\r\n\r\n\r\n<p>This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <a href=\"http://rmarkdown.rstudio.com\" class=\"uri\">http://rmarkdown.rstudio.com</a>.</p>\r\n<p>When you click the <strong>Knit</strong> button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:</p>\r\n<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>\r\n<pre class=\"r\"><code>library(caret)</code></pre>\r\n<pre><code>## Loading required package: lattice\r\n## Loading required package: ggplot2</code></pre>\r\n<pre class=\"r\"><code>library(rpart)\r\nlibrary(e1071)\r\nlibrary(MASS)\r\nlibrary(randomForest)</code></pre>\r\n<pre><code>## randomForest 4.6-12\r\n## Type rfNews() to see new features/changes/bug fixes.\r\n## \r\n## Attaching package: 'randomForest'\r\n## \r\n## The following object is masked from 'package:ggplot2':\r\n## \r\n##     margin</code></pre>\r\n<pre class=\"r\"><code>library(rpart.plot)\r\nlibrary(adabag)</code></pre>\r\n<pre><code>## Loading required package: mlbench</code></pre>\r\n<pre class=\"r\"><code>set.seed(111)\r\n\r\n# After saving both data sets into my working directory\r\n# Some missing values are coded as string &quot;#DIV/0!&quot; or &quot;&quot; or &quot;NA&quot; - these will be changed to NA.\r\n# We notice that both data sets contain columns with all missing values - these will be deleted.  \r\n\r\n# Loading the training data set into my R session replacing all missing with &quot;NA&quot;\r\ntrainingset &lt;- read.csv(url('https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'), na.strings=c(&quot;NA&quot;,&quot;#DIV/0!&quot;, &quot;&quot;))\r\n\r\n# Loading the testing data set \r\ntestingset &lt;- read.csv(url('https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv'), na.strings=c(&quot;NA&quot;,&quot;#DIV/0!&quot;, &quot;&quot;))\r\n\r\n# Check dimensions for number of variables and number of observations\r\ndim(trainingset)</code></pre>\r\n<pre><code>## [1] 19622   160</code></pre>\r\n<pre class=\"r\"><code>dim(testingset)</code></pre>\r\n<pre><code>## [1]  20 160</code></pre>\r\n<pre class=\"r\"><code># combine data\r\n\r\n#newdata=rbind(trainingset,testingset)\r\n\r\n# Delete columns with all missing values\r\ntrainingset&lt;-trainingset[,colSums(is.na(trainingset)) == 0]\r\ntestingset &lt;-testingset[,colSums(is.na(testingset)) == 0]\r\n\r\n# Remove some variables are irrelevant to our current project\r\ntrainingset   &lt;-trainingset[,-c(1:7)]\r\ntestingset &lt;-testingset[,-c(1:7)]\r\n\r\n# new sub-datasets:\r\ndim(trainingset)</code></pre>\r\n<pre><code>## [1] 19622    53</code></pre>\r\n<pre class=\"r\"><code>dim(testingset)</code></pre>\r\n<pre><code>## [1] 20 53</code></pre>\r\n<pre class=\"r\"><code>head(trainingset)</code></pre>\r\n<pre><code>##   roll_belt pitch_belt yaw_belt total_accel_belt gyros_belt_x gyros_belt_y\r\n## 1      1.41       8.07    -94.4                3         0.00         0.00\r\n## 2      1.41       8.07    -94.4                3         0.02         0.00\r\n## 3      1.42       8.07    -94.4                3         0.00         0.00\r\n## 4      1.48       8.05    -94.4                3         0.02         0.00\r\n## 5      1.48       8.07    -94.4                3         0.02         0.02\r\n## 6      1.45       8.06    -94.4                3         0.02         0.00\r\n##   gyros_belt_z accel_belt_x accel_belt_y accel_belt_z magnet_belt_x\r\n## 1        -0.02          -21            4           22            -3\r\n## 2        -0.02          -22            4           22            -7\r\n## 3        -0.02          -20            5           23            -2\r\n## 4        -0.03          -22            3           21            -6\r\n## 5        -0.02          -21            2           24            -6\r\n## 6        -0.02          -21            4           21             0\r\n##   magnet_belt_y magnet_belt_z roll_arm pitch_arm yaw_arm total_accel_arm\r\n## 1           599          -313     -128      22.5    -161              34\r\n## 2           608          -311     -128      22.5    -161              34\r\n## 3           600          -305     -128      22.5    -161              34\r\n## 4           604          -310     -128      22.1    -161              34\r\n## 5           600          -302     -128      22.1    -161              34\r\n## 6           603          -312     -128      22.0    -161              34\r\n##   gyros_arm_x gyros_arm_y gyros_arm_z accel_arm_x accel_arm_y accel_arm_z\r\n## 1        0.00        0.00       -0.02        -288         109        -123\r\n## 2        0.02       -0.02       -0.02        -290         110        -125\r\n## 3        0.02       -0.02       -0.02        -289         110        -126\r\n## 4        0.02       -0.03        0.02        -289         111        -123\r\n## 5        0.00       -0.03        0.00        -289         111        -123\r\n## 6        0.02       -0.03        0.00        -289         111        -122\r\n##   magnet_arm_x magnet_arm_y magnet_arm_z roll_dumbbell pitch_dumbbell\r\n## 1         -368          337          516      13.05217      -70.49400\r\n## 2         -369          337          513      13.13074      -70.63751\r\n## 3         -368          344          513      12.85075      -70.27812\r\n## 4         -372          344          512      13.43120      -70.39379\r\n## 5         -374          337          506      13.37872      -70.42856\r\n## 6         -369          342          513      13.38246      -70.81759\r\n##   yaw_dumbbell total_accel_dumbbell gyros_dumbbell_x gyros_dumbbell_y\r\n## 1    -84.87394                   37                0            -0.02\r\n## 2    -84.71065                   37                0            -0.02\r\n## 3    -85.14078                   37                0            -0.02\r\n## 4    -84.87363                   37                0            -0.02\r\n## 5    -84.85306                   37                0            -0.02\r\n## 6    -84.46500                   37                0            -0.02\r\n##   gyros_dumbbell_z accel_dumbbell_x accel_dumbbell_y accel_dumbbell_z\r\n## 1             0.00             -234               47             -271\r\n## 2             0.00             -233               47             -269\r\n## 3             0.00             -232               46             -270\r\n## 4            -0.02             -232               48             -269\r\n## 5             0.00             -233               48             -270\r\n## 6             0.00             -234               48             -269\r\n##   magnet_dumbbell_x magnet_dumbbell_y magnet_dumbbell_z roll_forearm\r\n## 1              -559               293               -65         28.4\r\n## 2              -555               296               -64         28.3\r\n## 3              -561               298               -63         28.3\r\n## 4              -552               303               -60         28.1\r\n## 5              -554               292               -68         28.0\r\n## 6              -558               294               -66         27.9\r\n##   pitch_forearm yaw_forearm total_accel_forearm gyros_forearm_x\r\n## 1         -63.9        -153                  36            0.03\r\n## 2         -63.9        -153                  36            0.02\r\n## 3         -63.9        -152                  36            0.03\r\n## 4         -63.9        -152                  36            0.02\r\n## 5         -63.9        -152                  36            0.02\r\n## 6         -63.9        -152                  36            0.02\r\n##   gyros_forearm_y gyros_forearm_z accel_forearm_x accel_forearm_y\r\n## 1            0.00           -0.02             192             203\r\n## 2            0.00           -0.02             192             203\r\n## 3           -0.02            0.00             196             204\r\n## 4           -0.02            0.00             189             206\r\n## 5            0.00           -0.02             189             206\r\n## 6           -0.02           -0.03             193             203\r\n##   accel_forearm_z magnet_forearm_x magnet_forearm_y magnet_forearm_z\r\n## 1            -215              -17              654              476\r\n## 2            -216              -18              661              473\r\n## 3            -213              -18              658              469\r\n## 4            -214              -16              658              469\r\n## 5            -214              -17              655              473\r\n## 6            -215               -9              660              478\r\n##   classe\r\n## 1      A\r\n## 2      A\r\n## 3      A\r\n## 4      A\r\n## 5      A\r\n## 6      A</code></pre>\r\n<pre class=\"r\"><code>head(testingset)</code></pre>\r\n<pre><code>##   roll_belt pitch_belt yaw_belt total_accel_belt gyros_belt_x gyros_belt_y\r\n## 1    123.00      27.00    -4.75               20        -0.50        -0.02\r\n## 2      1.02       4.87   -88.90                4        -0.06        -0.02\r\n## 3      0.87       1.82   -88.50                5         0.05         0.02\r\n## 4    125.00     -41.60   162.00               17         0.11         0.11\r\n## 5      1.35       3.33   -88.60                3         0.03         0.02\r\n## 6     -5.92       1.59   -87.70                4         0.10         0.05\r\n##   gyros_belt_z accel_belt_x accel_belt_y accel_belt_z magnet_belt_x\r\n## 1        -0.46          -38           69         -179           -13\r\n## 2        -0.07          -13           11           39            43\r\n## 3         0.03            1           -1           49            29\r\n## 4        -0.16           46           45         -156           169\r\n## 5         0.00           -8            4           27            33\r\n## 6        -0.13          -11          -16           38            31\r\n##   magnet_belt_y magnet_belt_z roll_arm pitch_arm yaw_arm total_accel_arm\r\n## 1           581          -382     40.7    -27.80     178              10\r\n## 2           636          -309      0.0      0.00       0              38\r\n## 3           631          -312      0.0      0.00       0              44\r\n## 4           608          -304   -109.0     55.00    -142              25\r\n## 5           566          -418     76.1      2.76     102              29\r\n## 6           638          -291      0.0      0.00       0              14\r\n##   gyros_arm_x gyros_arm_y gyros_arm_z accel_arm_x accel_arm_y accel_arm_z\r\n## 1       -1.65        0.48       -0.18          16          38          93\r\n## 2       -1.17        0.85       -0.43        -290         215         -90\r\n## 3        2.10       -1.36        1.13        -341         245         -87\r\n## 4        0.22       -0.51        0.92        -238         -57           6\r\n## 5       -1.96        0.79       -0.54        -197         200         -30\r\n## 6        0.02        0.05       -0.07         -26         130         -19\r\n##   magnet_arm_x magnet_arm_y magnet_arm_z roll_dumbbell pitch_dumbbell\r\n## 1         -326          385          481     -17.73748       24.96085\r\n## 2         -325          447          434      54.47761      -53.69758\r\n## 3         -264          474          413      57.07031      -51.37303\r\n## 4         -173          257          633      43.10927      -30.04885\r\n## 5         -170          275          617    -101.38396      -53.43952\r\n## 6          396          176          516      62.18750      -50.55595\r\n##   yaw_dumbbell total_accel_dumbbell gyros_dumbbell_x gyros_dumbbell_y\r\n## 1    126.23596                    9             0.64             0.06\r\n## 2    -75.51480                   31             0.34             0.05\r\n## 3    -75.20287                   29             0.39             0.14\r\n## 4   -103.32003                   18             0.10            -0.02\r\n## 5    -14.19542                    4             0.29            -0.47\r\n## 6    -71.12063                   29            -0.59             0.80\r\n##   gyros_dumbbell_z accel_dumbbell_x accel_dumbbell_y accel_dumbbell_z\r\n## 1            -0.61               21              -15               81\r\n## 2            -0.71             -153              155             -205\r\n## 3            -0.34             -141              155             -196\r\n## 4             0.05              -51               72             -148\r\n## 5            -0.46              -18              -30               -5\r\n## 6             1.10             -138              166             -186\r\n##   magnet_dumbbell_x magnet_dumbbell_y magnet_dumbbell_z roll_forearm\r\n## 1               523              -528               -56          141\r\n## 2              -502               388               -36          109\r\n## 3              -506               349                41          131\r\n## 4              -576               238                53            0\r\n## 5              -424               252               312         -176\r\n## 6              -543               262                96          150\r\n##   pitch_forearm yaw_forearm total_accel_forearm gyros_forearm_x\r\n## 1         49.30       156.0                  33            0.74\r\n## 2        -17.60       106.0                  39            1.12\r\n## 3        -32.60        93.0                  34            0.18\r\n## 4          0.00         0.0                  43            1.38\r\n## 5         -2.16       -47.9                  24           -0.75\r\n## 6          1.46        89.7                  43           -0.88\r\n##   gyros_forearm_y gyros_forearm_z accel_forearm_x accel_forearm_y\r\n## 1           -3.34           -0.59            -110             267\r\n## 2           -2.78           -0.18             212             297\r\n## 3           -0.79            0.28             154             271\r\n## 4            0.69            1.80             -92             406\r\n## 5            3.10            0.80             131             -93\r\n## 6            4.26            1.35             230             322\r\n##   accel_forearm_z magnet_forearm_x magnet_forearm_y magnet_forearm_z\r\n## 1            -149             -714              419              617\r\n## 2            -118             -237              791              873\r\n## 3            -129              -51              698              783\r\n## 4             -39             -233              783              521\r\n## 5             172              375             -787               91\r\n## 6            -144             -300              800              884\r\n##   problem_id\r\n## 1          1\r\n## 2          2\r\n## 3          3\r\n## 4          4\r\n## 5          5\r\n## 6          6</code></pre>\r\n<pre class=\"r\"><code>subsamples &lt;- createDataPartition(y=trainingset$classe, p=0.75, list=FALSE)\r\nsub_train_set &lt;- trainingset[subsamples, ] \r\nTestset_sub &lt;- trainingset[-subsamples, ]\r\ndim(sub_train_set)</code></pre>\r\n<pre><code>## [1] 14718    53</code></pre>\r\n<pre class=\"r\"><code>dim(Testset_sub)</code></pre>\r\n<pre><code>## [1] 4904   53</code></pre>\r\n<pre class=\"r\"><code>head(sub_train_set)</code></pre>\r\n<pre><code>##   roll_belt pitch_belt yaw_belt total_accel_belt gyros_belt_x gyros_belt_y\r\n## 1      1.41       8.07    -94.4                3         0.00            0\r\n## 2      1.41       8.07    -94.4                3         0.02            0\r\n## 3      1.42       8.07    -94.4                3         0.00            0\r\n## 4      1.48       8.05    -94.4                3         0.02            0\r\n## 6      1.45       8.06    -94.4                3         0.02            0\r\n## 7      1.42       8.09    -94.4                3         0.02            0\r\n##   gyros_belt_z accel_belt_x accel_belt_y accel_belt_z magnet_belt_x\r\n## 1        -0.02          -21            4           22            -3\r\n## 2        -0.02          -22            4           22            -7\r\n## 3        -0.02          -20            5           23            -2\r\n## 4        -0.03          -22            3           21            -6\r\n## 6        -0.02          -21            4           21             0\r\n## 7        -0.02          -22            3           21            -4\r\n##   magnet_belt_y magnet_belt_z roll_arm pitch_arm yaw_arm total_accel_arm\r\n## 1           599          -313     -128      22.5    -161              34\r\n## 2           608          -311     -128      22.5    -161              34\r\n## 3           600          -305     -128      22.5    -161              34\r\n## 4           604          -310     -128      22.1    -161              34\r\n## 6           603          -312     -128      22.0    -161              34\r\n## 7           599          -311     -128      21.9    -161              34\r\n##   gyros_arm_x gyros_arm_y gyros_arm_z accel_arm_x accel_arm_y accel_arm_z\r\n## 1        0.00        0.00       -0.02        -288         109        -123\r\n## 2        0.02       -0.02       -0.02        -290         110        -125\r\n## 3        0.02       -0.02       -0.02        -289         110        -126\r\n## 4        0.02       -0.03        0.02        -289         111        -123\r\n## 6        0.02       -0.03        0.00        -289         111        -122\r\n## 7        0.00       -0.03        0.00        -289         111        -125\r\n##   magnet_arm_x magnet_arm_y magnet_arm_z roll_dumbbell pitch_dumbbell\r\n## 1         -368          337          516      13.05217      -70.49400\r\n## 2         -369          337          513      13.13074      -70.63751\r\n## 3         -368          344          513      12.85075      -70.27812\r\n## 4         -372          344          512      13.43120      -70.39379\r\n## 6         -369          342          513      13.38246      -70.81759\r\n## 7         -373          336          509      13.12695      -70.24757\r\n##   yaw_dumbbell total_accel_dumbbell gyros_dumbbell_x gyros_dumbbell_y\r\n## 1    -84.87394                   37                0            -0.02\r\n## 2    -84.71065                   37                0            -0.02\r\n## 3    -85.14078                   37                0            -0.02\r\n## 4    -84.87363                   37                0            -0.02\r\n## 6    -84.46500                   37                0            -0.02\r\n## 7    -85.09961                   37                0            -0.02\r\n##   gyros_dumbbell_z accel_dumbbell_x accel_dumbbell_y accel_dumbbell_z\r\n## 1             0.00             -234               47             -271\r\n## 2             0.00             -233               47             -269\r\n## 3             0.00             -232               46             -270\r\n## 4            -0.02             -232               48             -269\r\n## 6             0.00             -234               48             -269\r\n## 7             0.00             -232               47             -270\r\n##   magnet_dumbbell_x magnet_dumbbell_y magnet_dumbbell_z roll_forearm\r\n## 1              -559               293               -65         28.4\r\n## 2              -555               296               -64         28.3\r\n## 3              -561               298               -63         28.3\r\n## 4              -552               303               -60         28.1\r\n## 6              -558               294               -66         27.9\r\n## 7              -551               295               -70         27.9\r\n##   pitch_forearm yaw_forearm total_accel_forearm gyros_forearm_x\r\n## 1         -63.9        -153                  36            0.03\r\n## 2         -63.9        -153                  36            0.02\r\n## 3         -63.9        -152                  36            0.03\r\n## 4         -63.9        -152                  36            0.02\r\n## 6         -63.9        -152                  36            0.02\r\n## 7         -63.9        -152                  36            0.02\r\n##   gyros_forearm_y gyros_forearm_z accel_forearm_x accel_forearm_y\r\n## 1            0.00           -0.02             192             203\r\n## 2            0.00           -0.02             192             203\r\n## 3           -0.02            0.00             196             204\r\n## 4           -0.02            0.00             189             206\r\n## 6           -0.02           -0.03             193             203\r\n## 7            0.00           -0.02             195             205\r\n##   accel_forearm_z magnet_forearm_x magnet_forearm_y magnet_forearm_z\r\n## 1            -215              -17              654              476\r\n## 2            -216              -18              661              473\r\n## 3            -213              -18              658              469\r\n## 4            -214              -16              658              469\r\n## 6            -215               -9              660              478\r\n## 7            -215              -18              659              470\r\n##   classe\r\n## 1      A\r\n## 2      A\r\n## 3      A\r\n## 4      A\r\n## 6      A\r\n## 7      A</code></pre>\r\n<pre class=\"r\"><code>head(Testset_sub)</code></pre>\r\n<pre><code>##    roll_belt pitch_belt yaw_belt total_accel_belt gyros_belt_x\r\n## 5       1.48       8.07    -94.4                3         0.02\r\n## 8       1.42       8.13    -94.4                3         0.02\r\n## 17      1.51       8.12    -94.4                3         0.00\r\n## 19      1.57       8.06    -94.4                3         0.00\r\n## 21      1.60       8.10    -94.4                3         0.02\r\n## 24      1.51       8.10    -94.4                3         0.02\r\n##    gyros_belt_y gyros_belt_z accel_belt_x accel_belt_y accel_belt_z\r\n## 5          0.02        -0.02          -21            2           24\r\n## 8          0.00        -0.02          -22            4           21\r\n## 17         0.00        -0.02          -21            4           22\r\n## 19         0.00        -0.02          -20            5           21\r\n## 21         0.00        -0.02          -20            1           20\r\n## 24         0.00        -0.02          -20            4           22\r\n##    magnet_belt_x magnet_belt_y magnet_belt_z roll_arm pitch_arm yaw_arm\r\n## 5             -6           600          -302     -128      22.1    -161\r\n## 8             -2           603          -313     -128      21.8    -161\r\n## 17            -6           598          -317     -129      21.3    -161\r\n## 19            -3           603          -313     -129      21.2    -161\r\n## 21           -10           607          -304     -129      20.9    -161\r\n## 24            -3           601          -318     -129      20.7    -161\r\n##    total_accel_arm gyros_arm_x gyros_arm_y gyros_arm_z accel_arm_x\r\n## 5               34        0.00       -0.03        0.00        -289\r\n## 8               34        0.02       -0.02        0.00        -289\r\n## 17              34        0.02        0.00       -0.02        -289\r\n## 19              34        0.02       -0.02       -0.02        -289\r\n## 21              34        0.03       -0.02       -0.02        -288\r\n## 24              34       -0.02        0.00       -0.02        -289\r\n##    accel_arm_y accel_arm_z magnet_arm_x magnet_arm_y magnet_arm_z\r\n## 5          111        -123         -374          337          506\r\n## 8          111        -124         -372          338          510\r\n## 17         110        -122         -371          337          512\r\n## 19         109        -122         -369          340          509\r\n## 21         111        -124         -375          337          513\r\n## 24         110        -125         -374          350          516\r\n##    roll_dumbbell pitch_dumbbell yaw_dumbbell total_accel_dumbbell\r\n## 5       13.37872      -70.42856    -84.85306                   37\r\n## 8       12.75083      -70.34768    -85.09708                   37\r\n## 17      13.04835      -70.10639    -85.26058                   37\r\n## 19      13.07574      -70.28271    -85.07803                   37\r\n## 21      13.38246      -70.81759    -84.46500                   37\r\n## 24      13.00000      -70.70000    -84.70000                   37\r\n##    gyros_dumbbell_x gyros_dumbbell_y gyros_dumbbell_z accel_dumbbell_x\r\n## 5                 0            -0.02             0.00             -233\r\n## 8                 0            -0.02             0.00             -234\r\n## 17                0            -0.02             0.00             -233\r\n## 19                0            -0.02            -0.02             -233\r\n## 21                0            -0.02             0.00             -234\r\n## 24                0            -0.02             0.00             -235\r\n##    accel_dumbbell_y accel_dumbbell_z magnet_dumbbell_x magnet_dumbbell_y\r\n## 5                48             -270              -554               292\r\n## 8                46             -272              -555               300\r\n## 17               47             -272              -551               296\r\n## 19               47             -271              -559               295\r\n## 21               48             -269              -554               299\r\n## 24               47             -271              -558               291\r\n##    magnet_dumbbell_z roll_forearm pitch_forearm yaw_forearm\r\n## 5                -68         28.0         -63.9        -152\r\n## 8                -74         27.8         -63.8        -152\r\n## 17               -56         27.1         -64.0        -151\r\n## 19               -74         26.9         -64.0        -151\r\n## 21               -72         26.9         -63.9        -151\r\n## 24               -71         27.1         -63.7        -151\r\n##    total_accel_forearm gyros_forearm_x gyros_forearm_y gyros_forearm_z\r\n## 5                   36            0.02            0.00           -0.02\r\n## 8                   36            0.02           -0.02            0.00\r\n## 17                  36            0.02           -0.02            0.00\r\n## 19                  36            0.02            0.00           -0.02\r\n## 21                  36            0.03           -0.03           -0.02\r\n## 24                  36            0.03           -0.03            0.00\r\n##    accel_forearm_x accel_forearm_y accel_forearm_z magnet_forearm_x\r\n## 5              189             206            -214              -17\r\n## 8              193             205            -213               -9\r\n## 17             192             204            -213              -13\r\n## 19             192             203            -216              -10\r\n## 21             194             208            -214              -11\r\n## 24             193             203            -213              -11\r\n##    magnet_forearm_y magnet_forearm_z classe\r\n## 5               655              473      A\r\n## 8               660              474      A\r\n## 17              653              481      A\r\n## 19              657              466      A\r\n## 21              654              469      A\r\n## 24              661              470      A</code></pre>\r\n<pre class=\"r\"><code>plot(table(sub_train_set$classe), col=&quot;red&quot;, main=&quot;Levels of the variable classe within the sub-training data set&quot;, xlab=&quot;classe levels&quot;, ylab=&quot;Frequency&quot;,ylim = c(0,5000))\r\n\r\n\r\ntext(1:5,table(sub_train_set$classe)+200,table(sub_train_set$classe))</code></pre>\r\n<p><img src='https://raw.githubusercontent.com/maoxiong233/Practical-Machine-Learning/ML/Work_files/figure-html/unnamed-chunk-5-1.png' alt=\"hi\" class=\"inline\"/>\r\n\r\n<pre class=\"r\"><code>model.rpart &lt;- rpart(classe ~ ., data=sub_train_set, method=&quot;class&quot;)\r\n\r\n# Predicting:\r\nprediction1 &lt;- predict(model.rpart, Testset_sub, type = &quot;class&quot;)\r\n\r\n# Plot of the Decision Tree\r\nplot(model.rpart, main=&quot;Classification Tree&quot;)\r\ntext(model.rpart, use.n=F, all=F, cex=.5)</code></pre>\r\n\r\n<p><img src='https://raw.githubusercontent.com/maoxiong233/Practical-Machine-Learning/ML/Work_files/figure-html/unnamed-chunk-6-1.png' alt=\"hi\" class=\"inline\"/>\r\n\r\n<pre class=\"r\"><code># Test results on our Testset_sub data set:\r\nm.rpart=confusionMatrix(prediction1, Testset_sub$classe)$overall['Accuracy']</code></pre>\r\n<pre class=\"r\"><code>#  randomForest\r\nmodel.rf &lt;- randomForest(classe ~. , data=sub_train_set, method=&quot;rf&quot;, prox=T)\r\n\r\n# Predicting:\r\nprediction2 &lt;- predict(model.rf, Testset_sub, type = &quot;class&quot;)\r\n\r\n# Test results on Testset_sub data set:\r\nm.rf=confusionMatrix(prediction2, Testset_sub$classe)$overall['Accuracy']</code></pre>\r\n<pre class=\"r\"><code>#  qda\r\nmodel.qda &lt;- train(classe ~. , data=sub_train_set, method=&quot;qda&quot;)\r\n\r\n# Predicting:\r\nprediction3 &lt;- predict(model.qda, Testset_sub)\r\n\r\n# Test results on Testset_sub data set:\r\nm.qda=confusionMatrix(prediction3, Testset_sub$classe)$overall['Accuracy']</code></pre>\r\n<pre class=\"r\"><code>#  svm\r\n\r\nmodel.svm &lt;- svm(classe ~. , data=sub_train_set,kernel =&quot;radial&quot;)\r\n\r\n# Predicting:\r\nprediction4 &lt;- predict(model.svm, Testset_sub)\r\n\r\n# Test results on Testset_sub data set:\r\nm.svm=confusionMatrix(prediction4, Testset_sub$classe)$overall['Accuracy']</code></pre>\r\n<pre class=\"r\"><code># BOOSTED TREE MODEL\r\nlibrary(adabag)\r\n\r\nmodel.boosting &lt;- boosting(classe ~. , data=sub_train_set)\r\n\r\n# Predicting:\r\nprediction5 &lt;- predict(model.boosting, Testset_sub, type='class')\r\n\r\n# Test results on Testset_sub data set:\r\nm.boosting=confusionMatrix(prediction5$class,Testset_sub$classe)$overall['Accuracy']</code></pre>\r\n<pre class=\"r\"><code>#model comparison\r\naccu=c('Rpar'=m.rpart,'RandomForst'=m.rf,'QDA'=m.qda,'SVM'=m.svm,'Boosting'=m.boosting)\r\n\r\nn=which.max(accu)\r\n\r\nprint(n)</code></pre>\r\n<pre><code>## RandomForst.Accuracy \r\n##                    2</code></pre>\r\n<pre class=\"r\"><code>#Submission\r\nmodel.best=model.rf\r\n\r\n# predict outcome levels on the original Testing data set using best model\r\npredictfinal &lt;- predict(model.best, testingset, type=&quot;class&quot;)\r\npredictfinal</code></pre>\r\n<pre><code>##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 \r\n##  B  A  B  A  A  E  D  B  A  A  B  C  B  A  E  E  A  B  B  B \r\n## Levels: A B C D E</code></pre>\r\n<pre class=\"r\"><code># Write files for submission\r\npml_write_files = function(x){\r\n  n = length(x)\r\n  for(i in 1:n){\r\n    filename = paste0(&quot;problem_id_&quot;,i,&quot;.txt&quot;)\r\n    write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)\r\n  }\r\n}\r\n\r\npml_write_files(predictfinal)</code></pre>\r\n\r\n\r\n</div>\r\n\r\n<script>\r\n\r\n// add bootstrap table styles to pandoc tables\r\n$(document).ready(function () {\r\n  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r\n});\r\n\r\n</script>\r\n\r\n<!-- dynamically load mathjax for compatibility with self-contained -->\r\n<script>\r\n  (function () {\r\n    var script = document.createElement(\"script\");\r\n    script.type = \"text/javascript\";\r\n    script.src  = \"https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\r\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\r\n  })();\r\n</script>\r\n\r\n</body>\r\n</html>","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}